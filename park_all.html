<!DOCTYPE html><html><head><meta charset='utf-8'><meta http-equiv='Access-Control-Allow-Origin' content='*'><meta http-equiv='Access-Control-Allow-Credentials' content='true'><script src='https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/gameelements.js'></script><link rel='stylesheet' href='https://fustyles.github.io/webduino/SpBlocklyJS/css/icon_custom.css' /><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/spreadsheetsql.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/loader.js'></script></head><body><script>const delay=(seconds)=>{return new Promise((resolve)=>{setTimeout(resolve,seconds*1000);});};const main=async()=>{
var i, _E8_A9_A6_E7_AE_97_E8_A1_A8ID, arr, spreadsheetID, sheetName;

function spreadsheetsql_QueryResponse_(res) {
  spreadsheetsql_QueryResponse(res, "");
}
window.spreadsheetsql_QueryResponse_ = spreadsheetsql_QueryResponse_;


i = 0;
_E8_A9_A6_E7_AE_97_E8_A1_A8ID = '1Vw73T24l1Efbp_BNxY0zqN4sfvQ-V-nnlNIWCNC-vsU';
span_create('',0,10,30,'查詢類別',999);
select_create('',200,50,140,10,'#ffffff','#000000',30,1,[],'',999,true);
async function gameselect__onchange (event) {
  alert((select_get('',"selectedValue")));
  alert((select_get('',"selectedText")));
  if ((select_get('',"selectedText")) == '基隆縣') {
    spreadsheetID = '1Vw73T24l1Efbp_BNxY0zqN4sfvQ-V-nnlNIWCNC-vsU';
    sheetName = '工作表1';
    spreadsheetsql_settings(spreadsheetID,sheetName, "");
    button_create('park1',80,50,100,300,1,null,'停車場1',14,999,true);
    button_create('park2',80,50,200,300,1,null,'停車場2',14,999,true);
    async function gamebutton_park1_onclick (event) {
      spreadsheetsql_executeSql('select max(A)', "");
      spreadsheetsql_getDataFinish_ = function(head_response, response) {
        spreadsheetsql_getDataTable('',180,20,100,150,false,"");

      };
    };
    document.getElementById("gamebutton_park1").addEventListener("click", gamebutton_park1_onclick, true);
    async function gamebutton_park2_onclick (event) {
      spreadsheetsql_executeSql('select max(B)', "");
      spreadsheetsql_getDataFinish_ = function(head_response, response) {
        spreadsheetsql_getDataTable('',180,20,100,150,false,"");

      };
    };
    document.getElementById("gamebutton_park2").addEventListener("click", gamebutton_park2_onclick, true);
  }
};
document.getElementById("gameselect_").addEventListener("change", gameselect__onchange, true);
spreadsheetsql_executeSql('select E', "");
spreadsheetsql_getDataFinish_ = function(head_response, response) {
  var arr = [['', '']];
  var i_end = (spreadsheetsql_getDataCount("ROWS",""));
  var i_inc = 1;
  if (1 > i_end) {
    i_inc = -i_inc;
  }
  for (i = 1; i_inc >= 0 ? i <= i_end : i >= i_end; i += i_inc) {
    if ((spreadsheetsql_getCell(1, i,"")) != null) {
      arr.push([i, spreadsheetsql_getCell(1, i,"")]);
    }
    select_set('',"option",arr);
  }

};
spreadsheetsql_settings(_E8_A9_A6_E7_AE_97_E8_A1_A8ID,'選單', "");
};main();</script></body></html>